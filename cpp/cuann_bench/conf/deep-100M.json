{
  "dataset" : {
    "name" : "deep-100M",
    "base_file" : "data/deep-1B/base.1B.fbin",
    "subset_size" : 100000000,
    "query_file" : "data/deep-1B/query.public.10K.fbin",
    // although distance should be "euclidean", faiss becomes much slower for that
    "distance" : "inner_product"
  },

  "search_basic_param" : {
    "batch_size" : 10000,
    "k" : 10,
    "run_count" : 2
  },

  "index" : [
    {
      "name" : "hnswlib.M12",
      "algo" : "hnswlib",
      "build_param": {"M":12, "efConstruction":500, "numThreads":32},
      "file" : "index/deep-100M/hnswlib/M12",
      "search_params" : [
        {"ef":10, "numThreads":1},
        {"ef":20, "numThreads":1},
        {"ef":40, "numThreads":1},
        {"ef":60, "numThreads":1},
        {"ef":80, "numThreads":1},
        {"ef":120, "numThreads":1},
        {"ef":200, "numThreads":1},
        {"ef":400, "numThreads":1},
        {"ef":600, "numThreads":1},
        {"ef":800, "numThreads":1}
      ],
      "search_result_file" : "result/deep-100M/hnswlib/M12"
    },
    {
      "name" : "hnswlib.M16",
      "algo" : "hnswlib",
      "build_param": {"M":16, "efConstruction":500, "numThreads":32},
      "file" : "index/deep-100M/hnswlib/M16",
      "search_params" : [
        {"ef":10, "numThreads":1},
        {"ef":20, "numThreads":1},
        {"ef":40, "numThreads":1},
        {"ef":60, "numThreads":1},
        {"ef":80, "numThreads":1},
        {"ef":120, "numThreads":1},
        {"ef":200, "numThreads":1},
        {"ef":400, "numThreads":1},
        {"ef":600, "numThreads":1},
        {"ef":800, "numThreads":1}
      ],
      "search_result_file" : "result/deep-100M/hnswlib/M16"
    },
    {
      "name" : "hnswlib.M24",
      "algo" : "hnswlib",
      "build_param": {"M":24, "efConstruction":500, "numThreads":32},
      "file" : "index/deep-100M/hnswlib/M24",
      "search_params" : [
        {"ef":10, "numThreads":1},
        {"ef":20, "numThreads":1},
        {"ef":40, "numThreads":1},
        {"ef":60, "numThreads":1},
        {"ef":80, "numThreads":1},
        {"ef":120, "numThreads":1},
        {"ef":200, "numThreads":1},
        {"ef":400, "numThreads":1},
        {"ef":600, "numThreads":1},
        {"ef":800, "numThreads":1}
      ],
      "search_result_file" : "result/deep-100M/hnswlib/M24"
    },
    {
      "name" : "hnswlib.M36",
      "algo" : "hnswlib",
      "build_param": {"M":36, "efConstruction":500, "numThreads":32},
      "file" : "index/deep-100M/hnswlib/M36",
      "search_params" : [
        {"ef":10, "numThreads":1},
        {"ef":20, "numThreads":1},
        {"ef":40, "numThreads":1},
        {"ef":60, "numThreads":1},
        {"ef":80, "numThreads":1},
        {"ef":120, "numThreads":1},
        {"ef":200, "numThreads":1},
        {"ef":400, "numThreads":1},
        {"ef":600, "numThreads":1},
        {"ef":800, "numThreads":1}
      ],
      "search_result_file" : "result/deep-100M/hnswlib/M36"
    },


    {
      "name" : "cugann.K64",
      "algo" : "cugann",
      "build_param": {
        "K": 64,
        "build_mode": "fast",
        "max_edge_num": 160,
        "rank_threshold": 6,
        "long_edge_threshold": 1.3
      },
      "file" : "index/deep-100M/cugann/K64",
      "search_params": [
        { "search_mode": "fast", "searcher_num":  50, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num":  64, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num":  96, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num": 128, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num": 144, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num": 160, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num": 176, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num": 192, "iteration_num": 6 },
        { "search_mode": "fast", "searcher_num":  50, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num":  64, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num":  96, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num": 128, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num": 144, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num": 160, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num": 176, "iteration_num": 7 },
        { "search_mode": "fast", "searcher_num": 192, "iteration_num": 7 }
      ],
      "search_result_file" : "result/deep-100M/cugann/K64"
    },
    {
      "name" : "cugann.K64-bulk",
      "algo" : "cugann",
      "build_param": {
        "K": 64,
        "build_mode": "fast",
        "max_edge_num": 160,
        "rank_threshold": 6,
        "long_edge_threshold": 1.3
      },
      "file" : "index/deep-100M/cugann/K64",
      "search_params": [
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 32, "iteration_num": 24 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 32, "iteration_num": 32 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 64, "iteration_num": 38 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 64, "iteration_num": 48 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 64, "iteration_num": 54 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 64, "iteration_num": 64 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 96, "iteration_num": 76 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 96, "iteration_num": 84 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 96, "iteration_num": 90 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 96, "iteration_num": 96 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 128, "iteration_num": 104 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 128, "iteration_num": 110 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 128, "iteration_num": 120 },
        { "search_mode": "bulk", "searcher_num": 1, "searcher_k": 128, "iteration_num": 128 }
      ],
      "search_result_file" : "result/deep-100M/cugann/K64-bulk"
    },


    {
      "name" : "cagra.k64",
      "algo" : "cagra",
      "build_param": {
      },
      "file" : "index/deep-100M/cagra/k96.pruned.k64",
      "search_params": [
        // { "batch_size":1, "k":10, "search_mode": "multi-cta", "internal_k": 32 },
        // { "batch_size":1, "k":10, "search_mode": "multi-cta", "internal_k": 64 },
        // { "batch_size":1, "k":10, "search_mode": "multi-cta", "internal_k": 96 },
        // { "batch_size":1, "k":10, "search_mode": "multi-cta", "internal_k": 128 },
        // { "batch_size":1, "k":10, "search_mode": "multi-cta", "internal_k": 160 },
        // { "batch_size":1, "k":10, "search_mode": "multi-cta", "internal_k": 192 }
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 32 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 32, "max_iterations":30 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 32, "max_iterations":40 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 32, "max_iterations":50 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 32, "max_iterations":60 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 64 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 64, "max_iterations":30 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 64, "max_iterations":40 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 64, "max_iterations":50 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 64, "max_iterations":60 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 96 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 128 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 160 },
        { "batch_size":10000, "k":10, "search_mode": "single-cta", "internal_k": 192 }
      ],
      "search_result_file" : "result/deep-100M/cagra/k64"
    },


    {
      "name" : "faiss_ivf_flat.nlist50K",
      "algo" : "faiss_gpu_ivf_flat",
      "build_param": {"nlist":50000},
      "file" : "index/deep-100M/faiss_ivf_flat/nlist50K",
      "search_params" : [
        {"nprobe":20},
        {"nprobe":30},
        {"nprobe":40},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500},
        {"nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/faiss_ivf_flat/nlist50K"
    },
    {
      "name" : "faiss_ivf_flat.nlist100K",
      "algo" : "faiss_gpu_ivf_flat",
      "build_param": {"nlist":100000},
      "file" : "index/deep-100M/faiss_ivf_flat/nlist100K",
      "search_params" : [
        {"nprobe":20},
        {"nprobe":30},
        {"nprobe":40},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500},
        {"nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/faiss_ivf_flat/nlist100K"
    },
    {
      "name" : "faiss_ivf_flat.nlist200K",
      "algo" : "faiss_gpu_ivf_flat",
      "build_param": {"nlist":200000},
      "file" : "index/deep-100M/faiss_ivf_flat/nlist200K",
      "search_params" : [
        {"nprobe":20},
        {"nprobe":30},
        {"nprobe":40},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500},
        {"nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/faiss_ivf_flat/nlist200K"
    },


    {
      "name" : "faiss_ivf_pq.M48-nlist16K",
      "algo" : "faiss_gpu_ivf_pq",
      "build_param": {"nlist":16384, "M":48},
      "file" : "index/deep-100M/faiss_ivf_pq/M48-nlist16K",
      "search_params" : [
        {"nprobe":10},
        {"nprobe":20},
        {"nprobe":30},
        {"nprobe":40},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500}
      ],
      "search_result_file" : "result/deep-100M/faiss_ivf_pq/M48-nlist16K"
    },
    {
      "name" : "faiss_ivf_pq.M48-nlist50K",
      "algo" : "faiss_gpu_ivf_pq",
      "build_param": {"nlist":50000, "M":48},
      "file" : "index/deep-100M/faiss_ivf_pq/M48-nlist50K",
      "search_params" : [
        {"nprobe":20},
        {"nprobe":30},
        {"nprobe":40},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500},
        {"nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/faiss_ivf_pq/M48-nlist50K"
    },
    {
      "name" : "faiss_ivf_pq.M48-nlist100K",
      "algo" : "faiss_gpu_ivf_pq",
      "build_param": {"nlist":100000, "M":48},
      "file" : "index/deep-100M/faiss_ivf_pq/M48-nlist100K",
      "search_params" : [
        {"nprobe":20},
        {"nprobe":30},
        {"nprobe":40},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500},
        {"nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/faiss_ivf_pq/M48-nlist100K"
    },


    {
      "name" : "ivf_flat.nlist100K",
      "algo" : "ivf_flat",
      "build_param": {
        "nlist" : 100000,
        "niter" : 25,
        "ratio" : 5
      },
      "file" : "index/deep-100M/ivf_flat/nlist100K",
      "search_params" : [
        {"max_batch":10000, "max_k":10, "nprobe":20},
        {"max_batch":10000, "max_k":10, "nprobe":30},
        {"max_batch":10000, "max_k":10, "nprobe":40},
        {"max_batch":10000, "max_k":10, "nprobe":50},
        {"max_batch":10000, "max_k":10, "nprobe":100},
        {"max_batch":10000, "max_k":10, "nprobe":200},
        {"max_batch":10000, "max_k":10, "nprobe":500},
        {"max_batch":10000, "max_k":10, "nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/ivf_flat/nlist100K"
    },


    {
      "name" : "libcuann.dimpq48-cluster50K.refine2",
      "algo" : "libcuann",
      "refine_ratio" : 2,
      "build_param": {
        "numDataset" : 100000000,
        "numClusters" : 50000,
        "dimPq" : 48
      },
      "file" : "index/deep-100M/libcuann/dimpq48-cluster50K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":20},
        {"max_batch_size":10000, "k":10, "numProbes":30},
        {"max_batch_size":10000, "k":10, "numProbes":40},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/libcuann/dimpq48-cluster50K.refine2"
    },
    {
      "name" : "libcuann.dimpq48-5bit-cluster50K.refine4",
      "algo" : "libcuann",
      "refine_ratio" : 4,
      "build_param": {
        "numDataset" : 100000000,
        "numClusters" : 50000,
        "dimPq" : 48,
        "bitPq" : 5
      },
      "file" : "index/deep-100M/libcuann/dimpq48-5bit-cluster50K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":20},
        {"max_batch_size":10000, "k":10, "numProbes":30},
        {"max_batch_size":10000, "k":10, "numProbes":40},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/libcuann/dimpq48-5bit-cluster50K.refine4"
    },
    {
      "name" : "libcuann.dimpq64-cluster50K.refine2",
      "algo" : "libcuann",
      "refine_ratio" : 2,
      "build_param": {
        "numDataset" : 100000000,
        "numClusters" : 50000,
        "dimPq" : 64
      },
      "file" : "index/deep-100M/libcuann/dimpq64-cluster50K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":20},
        {"max_batch_size":10000, "k":10, "numProbes":30},
        {"max_batch_size":10000, "k":10, "numProbes":40},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/libcuann/dimpq64-cluster50K.refine2"
    },
    {
      "name" : "libcuann.dimpq64-5bit-cluster50K.refine4",
      "algo" : "libcuann",
      "refine_ratio" : 4,
      "build_param": {
        "numDataset" : 100000000,
        "numClusters" : 50000,
        "dimPq" : 64,
        "bitPq" : 5
      },
      "file" : "index/deep-100M/libcuann/dimpq64-5bit-cluster50K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":20},
        {"max_batch_size":10000, "k":10, "numProbes":30},
        {"max_batch_size":10000, "k":10, "numProbes":40},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/libcuann/dimpq64-5bit-cluster50K.refine4"
    },
    {
      "name" : "libcuann.dimpq72-cluster50K",
      "algo" : "libcuann",
      "build_param": {
        "numDataset" : 100000000,
        "numClusters" : 50000,
        "dimPq" : 72
      },
      "file" : "index/deep-100M/libcuann/dimpq72-cluster50K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":20},
        {"max_batch_size":10000, "k":10, "numProbes":30},
        {"max_batch_size":10000, "k":10, "numProbes":40},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/libcuann/dimpq72-cluster50K"
    },
    {
      "name" : "libcuann.dimpq96-cluster50K",
      "algo" : "libcuann",
      "build_param": {
        "numDataset" : 100000000,
        "numClusters" : 50000,
        "dimPq" : 96
      },
      "file" : "index/deep-100M/libcuann/dimpq96-cluster50K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":20},
        {"max_batch_size":10000, "k":10, "numProbes":30},
        {"max_batch_size":10000, "k":10, "numProbes":40},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/libcuann/dimpq96-cluster50K"
    },


    // the following multigpu configurations are for validating correctness, not for measuring performance
    {
      "name" : "multigpu.faiss_ivf_flat.nlist10K",
      "algo" : "faiss_gpu_ivf_flat",
      "multigpu" : [0,1,2,3,4,5,6,7],
      "build_param": {"nlist":10000},
      "file" : "index/deep-100M/multigpu/faiss_ivf_flat.nlist10K",
      "search_params" : [
        {"nprobe":1},
        {"nprobe":5},
        {"nprobe":10},
        {"nprobe":50},
        {"nprobe":100},
        {"nprobe":200},
        {"nprobe":500},
        {"nprobe":1000}
      ],
      "search_result_file" : "result/deep-100M/multigpu/faiss_ivf_flat.nlist10K"
    },

    {
      "name" : "multigpu.libcuann.dimpq72-cluster10K",
      "algo" : "libcuann",
      "multigpu" : [0,1,2,3,4,5,6,7],
      "build_param": {
        "numDataset" : 12500000,
        "numClusters" : 10000,
        "dimPq" : 72
      },
      "file" : "index/deep-100M/multigpu/libcuann.dimpq72-cluster10K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":1},
        {"max_batch_size":10000, "k":10, "numProbes":5},
        {"max_batch_size":10000, "k":10, "numProbes":10},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/multigpu/libcuann.dimpq72-cluster10K"
    },

    {
      "name" : "multigpu.libcuann.dimpq72-cluster10K.refine2",
      "algo" : "libcuann",
      "multigpu" : [0,1,2,3,4,5,6,7],
      "refine_ratio" : 2,
      "build_param": {
        "numDataset" : 12500000,
        "numClusters" : 10000,
        "dimPq" : 72
      },
      "file" : "index/deep-100M/multigpu/libcuann.dimpq72-cluster10K",
      "search_params" : [
        {"max_batch_size":10000, "k":10, "numProbes":1},
        {"max_batch_size":10000, "k":10, "numProbes":5},
        {"max_batch_size":10000, "k":10, "numProbes":10},
        {"max_batch_size":10000, "k":10, "numProbes":50},
        {"max_batch_size":10000, "k":10, "numProbes":100},
        {"max_batch_size":10000, "k":10, "numProbes":200},
        {"max_batch_size":10000, "k":10, "numProbes":500},
        {"max_batch_size":10000, "k":10, "numProbes":1000}
      ],
      "search_result_file" : "result/deep-100M/multigpu/libcuann.dimpq72-cluster10K.refine2"
    }

  ]
}
